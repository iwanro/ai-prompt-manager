fix: Add robust checks for new user creation